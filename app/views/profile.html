<div>
  <h1>My profile</h1>
  <hr>
  <div>
    <h4>Details</h4>
    <dl class="dl-horizontal">
      <dt>Active</dt>
      <dd><input type="checkbox" ng-model="myDetails.active" disabled/></dd>
      <dt>Photo</dt>
      <dd><img ng-src="{{myDetails.photo}}" alt="Profile photo"/></dd>
      <dt>First name</dt>
      <dd>{{myDetails.firstName}}</dd>
      <dt>Last name</dt>
      <dd>{{myDetails.lastName}}</dd>
      <dt>Gender</dt>
      <dd>{{myDetails.gender}}</dd>
      <dt>Birth date</dt>
      <dd>{{myDetails.birthDate}}</dd>
      <dt>Address</dt>
      <dd>{{myDetails.address.street}} {{myDetails.address.streetNumber}}</dd>
      <dd>{{myDetails.address.zipCode}} {{myDetails.address.city}}</dd>
      <dd>{{myDetails.address.province}} {{myDetails.address.country}}</dd>
      <dt>Unit</dt>
      <dd>{{myDetails.unit}}</dd>
      <dt>Enrollment date</dt>
      <dd>{{myDetails.enrollmentDate}}</dd>
      <dt>Contact information</dt>
      <dd>{{myDetails.contactInformation}}</dd>
    </dl>
    <hr>
  </div>
  <div>
    <h4>Roles</h4>
    <table class="table table-hover table-striped table-bordered">
      <thead>
        <tr>
          <th>Functional roles</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="myFunctionalRole in myFunctionalRoles">
          <td>{{myFunctionalRole.name}}</td>
        </tr>
      </tbody>
    </table>
    <hr>
  </div>
  <div ng-if="hasCustomers">
    <h4>Customers</h4>
    <table class="table table-hover table-striped table-bordered">
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="myCustomer in myCustomers">
          <td>{{myCustomer.name}}</td>
          <td>{{myCustomer.description}}</td>
        </tr>
      </tbody>
    </table>
    <hr>
  </div>
  <div ng-if="hasBusinessUnitManagers">
    <h4>Business unit managers</h4>
    <table class="table table-hover table-striped table-bordered">
      <thead>
        <tr>
          <th>First name</th>
          <th>Last name</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="myBusinessUnitManager in myBusinessUnitManagers">
          <td>{{myBusinessUnitManager.firstName}}</td>
          <td>{{myBusinessUnitManager.lastName}}</td>
        </tr>
      </tbody>
    </table>
    <hr>
  </div>
  <div ng-if="hasCompetenceLeaders">
    <h4>Competence leaders</h4>
    <table class="table table-hover table-striped table-bordered">
      <thead>
        <tr>
          <th>First name</th>
          <th>Last name</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="myCompetenceLeader in myCompetenceLeaders">
          <td>{{myCompetenceLeader.firstName}}</td>
          <td>{{myCompetenceLeader.lastName}}</td>
        </tr>
      </tbody>
    </table>
    <hr>
  </div>
  <div ng-if="hasPracticeManagers">
    <h4>Practice managers</h4>
    <table class="table table-hover table-striped table-bordered">
      <thead>
        <tr>
          <th>First name</th>
          <th>Last name</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="myPracticeManager in myPracticeManagers">
          <td>{{myPracticeManager.firstName}}</td>
          <td>{{myPracticeManager.lastName}}</td>
        </tr>
      </tbody>
    </table>
    <hr>
  </div>
  <div ng-if="hasCoaches">
    <h4>Coaches</h4>
    <table class="table table-hover table-striped table-bordered">
      <thead>
        <tr>
          <th>First name</th>
          <th>Last name</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="myCoach in myCoaches">
          <td>{{myCoach.firstName}}</td>
          <td>{{myCoach.lastName}}</td>
        </tr>
      </tbody>
    </table>
    <hr>
  </div>
  <div ng-if="hasDescendants">
    <h4>Descendants</h4>
    <table class="table table-hover table-striped table-bordered">
      <thead>
        <tr>
          <th>First name</th>
          <th>Last name</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="myDescendant in myDescendants">
          <td>{{myDescendant.firstName}}</td>
          <td>{{myDescendant.lastName}}</td>
        </tr>
      </tbody>
    </table>
    <hr>
  </div>
  <div>
    <h4>Skill competences</h4>
    <div class="row">
      <div class="col-lg-6">
        <table class="table table-hover table-striped table-bordered">
          <thead>
            <tr>
              <th>Name</th>
              <th>Competence Level</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="skillCompetence in skillCompetences | filter:search" ng-click="setSelected(skill)">
              <td>{{skillCompetence.skill.name}}</td>
              <td>{{skillCompetence.competenceLevel}}</td>
              <td ng-click="remove(skillCompetence._links.self.href)">Delete</td>
            </tr>
            <tr>
              <form name="addForm">
                <td>
                  <input id="skill" class="form-control"
                       ng-model="skillCompetence.skill" typeahead-no-results="noResults"
                       typeahead="skill as skill.name for skill in skills | filter:$viewValue | limitTo:8"
                       placeholder="Skill"/>
                  <div ng-if="!skillCompetence.skill._links && skillCompetence.skill" class="alert alert-danger">Select a skill from the list.</div>
                </td>
                <td>
                  <input name="competenceLevel" ng-model="skillCompetence.competenceLevel" placeholder="Competence Level"
                       id="competenceLevel" class="form-control" type="number">
                </td>
                <td>
                  <button class="btn btn-default" ng-click="save(skillCompetence)">Add</button>
                </td>
              </form>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <hr>
  </div>
  <div>
    <h4>Credentials</h4>
    <div class="row">
      <div class="col-xs-6">
        <button type="button" class="btn btn-primary" ng-click="modalPasswordChange()">Change password</button>
      </div>
    </div>
    <hr>
  </div>
</div>

<script type="text/ng-template" id="passwordChangeModalContent">
  <div class="modal-header">
    <h3 class="modal-title">Change password</h3>
  </div>

  <div class="modal-body">
    <div ng-show="passwordChanged" class="alert alert-success" role="alert">
      Password successfully changed!
    </div>
    <div ng-show="passwordWrong" class="alert alert-danger" role="alert">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      Current password is not correct!
    </div>
    <form name="formChangePassword">
      <div class="form-group">
        <label for="oldPassword">Current password:</label>
        <input type="password" id="oldPassword" ng-model="password.oldPassword" placeholder="Old password" class="form-control" required/>
      </div>
      <div class="form-group">
        <label for="newPassword">New password:</label>
        <input type="password" id="newPassword" name="newPassword" ng-model="password.newPassword" ng-minlength="6" ng-maxlength="18" required placeholder="New password" class="form-control"/>
        <p ng-show="formChangePassword.newPassword.$touched && formChangePassword.newPassword.$error.minlength">Your password is required to be at least 6 characters</p>
        <p ng-show="formChangePassword.newPassword.$touched && formChangePassword.newPassword.$error.maxlength">Your password cannot be longer than 18 characters</p>
      </div>
      <div class="form-group">
        <label for="newPasswordConfirm">Confirm new password:</label>
        <input type="password" id="newPasswordConfirm" name="newPasswordConfirm" ng-model="password.newPasswordConfirm" required pw-check="newPassword" placeholder="Confirm new password" class="form-control" />
        <p ng-show="formChangePassword.$error"> <span class="msg-error" ng-show="formChangePassword.newPasswordConfirm.$error.pwmatch">Passwords don't match.</span></p>
      </div>
    </form>
  </div>

  <div class="modal-footer">
    <button class="btn btn-primary" ng-click="changePassword(password)" ng-disabled="formChangePassword.$invalid">Save</button>
    <button class="btn btn-warning" ng-click="cancelModal()">Cancel</button>
  </div>
</script>
